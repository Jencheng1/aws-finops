# FinOps Copilot: AWS Architecture Explanation

## System Architecture Overview

The FinOps Copilot system is built on AWS services and follows a serverless architecture pattern. The diagram illustrates the key components and their interactions:

### 1. User Interface Layer

- **User**: End users access the system through a web browser.
- **Streamlit Web Interface**: A Python-based web application that provides an interactive dashboard and chatbot interface for users to query AWS cost data and receive optimization recommendations.
- **Amazon Cognito**: Handles user authentication and authorization, ensuring secure access to the system.

### 2. API Layer

- **Amazon API Gateway**: Serves as the entry point for all API requests from the web interface, providing a secure and scalable API endpoint.

### 3. Intelligence Layer

- **Amazon Bedrock Orchestrator**: The main orchestrator agent built on AWS Bedrock that coordinates the entire system and processes natural language queries from users.
- **AWS Bedrock Agents**: Specialized agents that handle specific aspects of cost optimization:
  - Cost Analysis Agent
  - Resource Optimization Agent
  - Savings Plan Recommendation Agent

### 4. Integration Layer

- **AWS Lambda MCP Servers**: Serverless functions that implement the Model Context Protocol (MCP) to connect AWS Bedrock agents with various data sources. These include:
  - Cloudability MCP Server
  - Apptio MCP Server
  - AWS Cost Explorer MCP Server
  - AWS Resource Intelligence MCP Server

### 5. Data Source Layer

- **AWS Cost Explorer**: Provides detailed cost and usage data for AWS resources.
- **Amazon CloudWatch**: Provides metrics and logs for AWS resources to analyze utilization patterns.
- **AWS Trusted Advisor**: Provides recommendations for optimizing AWS resources and reducing costs.
- **External APIs**: Integration with third-party cost management platforms like IBM Cloudability and Apptio.

### 6. Storage Layer

- **Amazon S3**: Stores analysis results, reports, and other data generated by the system.

## Data Flow

1. The user submits a natural language query through the Streamlit web interface.
2. The query is sent to Amazon API Gateway, which forwards it to the Amazon Bedrock Orchestrator.
3. The Orchestrator analyzes the query and delegates tasks to specialized Bedrock agents.
4. The agents use Lambda-based MCP servers to retrieve data from various sources.
5. The MCP servers query AWS services (Cost Explorer, CloudWatch, Trusted Advisor) and external APIs (Cloudability, Apptio).
6. The agents process and analyze the data, generating insights and recommendations.
7. The Orchestrator combines the results from all agents and sends a comprehensive response back to the user.
8. The Streamlit interface presents the results with interactive visualizations and actionable recommendations.

## Key Benefits of This Architecture

1. **Serverless**: The architecture is fully serverless, eliminating the need to manage infrastructure and providing automatic scaling.
2. **Cost-Effective**: Services like Lambda and API Gateway follow a pay-per-use model, minimizing costs when the system is not in use.
3. **Scalable**: The system can handle varying loads, from individual users to enterprise-scale deployments.
4. **Secure**: Authentication is handled by Amazon Cognito, and all communications are secured through API Gateway.
5. **Extensible**: New data sources can be added by implementing additional MCP servers without changing the core architecture.
6. **AI-Powered**: AWS Bedrock provides advanced natural language processing capabilities for understanding user queries and generating insights.

## Implementation Considerations

1. **API Rate Limits**: Consider rate limits for AWS service APIs and external APIs when designing the system.
2. **Cost Management**: Monitor the usage of AWS services, especially Bedrock and Lambda, to control costs.
3. **Authentication**: Implement proper authentication and authorization using Cognito to ensure secure access to sensitive cost data.
4. **Data Privacy**: Ensure that cost data is handled securely and in compliance with organizational policies.
5. **Monitoring**: Set up CloudWatch alarms to monitor the health and performance of the system.
